// Generated by CoffeeScript 1.3.3
(function() {
  var extension, extensions, fs, parserSource, source, version, _i, _len,
    _this = this;

  version = '0.3.27';

  extensions = ['.opal', '.rb'];

  fs = require('fs');

  source = fs.readFileSync("" + __dirname + "/opal-" + version + ".js").toString();

  parserSource = fs.readFileSync("" + __dirname + "/opal-parser-" + version + ".js").toString();

  GLOBAL["eval"](source);

  GLOBAL["eval"](parserSource);

  Opal.parse = function(ruby, filename) {
    return Opal.Opal.Parser.$new().$parse(ruby, filename);
  };

  for (_i = 0, _len = extensions.length; _i < _len; _i++) {
    extension = extensions[_i];
    require.extensions[extension] = function(module, filename) {
      var ruby;
      ruby = fs.readFileSync("" + filename).toString();
      source = Opal.parse(ruby, filename);
      source = source.replace(/\/\/= require +(?:\.\/)?([^;]+)[\n;]/g, 'require("$1");');
      return module._compile(source, filename);
    };
  }

}).call(this);
